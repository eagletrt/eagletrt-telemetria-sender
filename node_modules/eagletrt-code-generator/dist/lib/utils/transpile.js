"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs_1 = require("fs");
var dree_1 = require("dree");
var parseTemplate_1 = require("./parseTemplate");
function transpile(src, codes, options, logger) {
    // Get scan options
    var scanOptions = {
        exclude: options.exclude,
        extensions: options.extensions
    };
    logger.info('Generating files from templates');
    // Scan all the files in the directory tree of the src folder
    dree_1.scan(src, scanOptions, function (file) {
        // If the file is a template file
        if (file.name.indexOf('.template') !== -1) {
            // Get its code
            var template = fs_1.readFileSync(file.path, 'utf-8');
            // Get the transpiled code, replacing all the special comments with generated code
            var generated = parseTemplate_1.parseTemplate(template, codes, options);
            // Get the path of the generated file
            var generatedPath = file.path.replace('.template', '');
            // Write the generated file
            fs_1.writeFileSync(generatedPath, generated);
            // Log the event
            logger.succ(file.relativePath.replace('.template', ''), 'GENERATED', true);
        }
    });
}
exports.transpile = transpile;
//# sourceMappingURL=transpile.js.map